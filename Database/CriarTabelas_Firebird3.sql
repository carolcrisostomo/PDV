-- create_firebird_schema.sql
-- Firebird 3.0 schema for the assessment

CREATE TABLE CADGRUPOPRODUTO (
  CODIGO INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  DESCRICAO VARCHAR(40)
);
CREATE TABLE CADPRODUTO (
  CODIGO INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  DESCRICAO VARCHAR(40),
  CODIGO_GRUPO INTEGER,
  VALOR NUMERIC(15,2),
  CONSTRAINT FK_PROD_GRUPO FOREIGN KEY (CODIGO_GRUPO) REFERENCES CADGRUPOPRODUTO(CODIGO)
);
CREATE TABLE VENDA (
  CODIGO INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  DATA DATE,
  VALOR_BRUTO NUMERIC(15,2),
  VALOR_DESCONTO NUMERIC(15,2),
  VALOR_LIQUIDO NUMERIC(15,2),
  CANCELADA VARCHAR(1) DEFAULT 'N'
);
CREATE TABLE VENDAITEM (
  CODIGO_SEQUENCIAL INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  CODIGO_VENDA INTEGER,
  CODIGO_PRODUTO INTEGER,
  VALOR NUMERIC(15,2),
  QTDE INTEGER,
  VALOR_SUBTOTAL NUMERIC(15,2),
  CONSTRAINT FK_VENDAITEM_VENDA FOREIGN KEY (CODIGO_VENDA) REFERENCES VENDA(CODIGO),
  CONSTRAINT FK_VENDAITEM_PROD FOREIGN KEY (CODIGO_PRODUTO) REFERENCES CADPRODUTO(CODIGO)
);
CREATE TABLE VENDARECEITA (
  CODIGO_SEQUENCIAL INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  CODIGO_VENDA INTEGER,
  CODIGO_RECEITA INTEGER,
  DESCRICAO_RECEITA VARCHAR(40),
  VALOR NUMERIC(15,2),
  CONSTRAINT FK_VENDARECEITA_VENDA FOREIGN KEY (CODIGO_VENDA) REFERENCES VENDA(CODIGO)
);
CREATE TABLE VENDADESCONTO (
  CODIGO_SEQUENCIAL INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  CODIGO_VENDA INTEGER,
  CODIGO_DESCONTO INTEGER,
  DESCRICAO_DESCONTO VARCHAR(40),
  PERCENTUAL NUMERIC(5,2),
  VALOR_PERCENTUAL NUMERIC(15,2),
  CONSTRAINT FK_VENDADESCONTO_VENDA FOREIGN KEY (CODIGO_VENDA) REFERENCES VENDA(CODIGO)
);


CREATE SEQUENCE GEN_CADGRUPOPRODUTO;
CREATE SEQUENCE GEN_CADPRODUTO;
CREATE SEQUENCE GEN_VENDA;
CREATE SEQUENCE GEN_VENDAITEM;
CREATE SEQUENCE GEN_VENDARECEITA;
CREATE SEQUENCE GEN_VENDADESCONTO;
